<!DOCTYPE html>

<html lang="zh-Hans-CN"><head><meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta charset="utf-8"/><meta content="IE=Edge" http-equiv="X-UA-Compatible"/><link href="css/modern-norm.min.css" rel="stylesheet" type="text/css"/><link href="css/prism.min.css" rel="stylesheet" type="text/css"/><link href="css/katex.min.css" rel="stylesheet" type="text/css"/><link href="css/wolai.css" rel="stylesheet" type="text/css"/><title>正则化项I - wolai 笔记</title><link rel="shortcut icon"/></head><body><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div class="main-title" data-title="正则化项I"></div></div></header><article><h2 class="wolai-block" id="otPWnmNYvMj94dJvPXQq4n"><span class="inline-wrap">正则化的直觉</span></h2><div class="wolai-block wolai-text" id="5YsSis2oywDVMPGP5xerLB"><div><span class="inline-wrap">正则化是除了验证（Validation）之外，对抗过拟合的另一大利器。</span></div></div><h3 class="wolai-block" id="868rMbvkuenerhVVdBWMXW"><span class="inline-wrap">来源与思想</span></h3><div class="wolai-block wolai-text" id="pQC8C4ev5vH8c9RhLLRDyM"><div><span class="inline-wrap"><b>回顾</b></span><span class="inline-wrap">：在机器学习中，我们的根本目标是构建一个具有优秀</span><span class="inline-wrap"><b>泛化能力</b></span><span class="inline-wrap">的模型，这意味着模型在未曾见过的新数据上也能表现良好。</span></div></div><div class="wolai-block wolai-text" id="wgeVNS5B2tcE9155ekCv8Y"><div><span class="inline-wrap">衡量这种能力的指标是</span><span class="inline-wrap"><b>泛化误差/样本外误差</b></span><span class="inline-wrap">（Out-of-Sample Error），记为</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>out</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Er}_\text{out}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">。然而，在训练过程中，我们能直接优化的只是模型在训练数据上的</span><span class="inline-wrap"><b>训练误差/样本内误差</b></span><span class="inline-wrap">（In-Sample Error），记为</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>in</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Er}_\text{in}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text" id="qwu7rJe1nMuuwaREVsTRX6"><div><span class="inline-wrap">学习理论，特别是<span class="jill"></span>VC<span class="jill"></span>理论，为这两者之间的关系提供了一个深刻的洞察，其泛化界可以概括为：</span></div></div><div class="wolai-block wolai-text" id="x3Q8px7iodyGHULatdKcEo"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>out</mtext></msub><mrow><mo fence="true">(</mo><mi>f</mi><mo fence="true">)</mo></mrow><mo>≤</mo><msub><mtext>Er</mtext><mtext>in</mtext></msub><mrow><mo fence="true">(</mo><mi>f</mi><mo fence="true">)</mo></mrow><mo>+</mo><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><mi mathvariant="script">H</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Er}_\text{out}\left(f\right)\le \text{Er}_\text{in}\left(f\right)+\Omega \left(\mathcal{H}\right)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="oLkARqJWw5LqSnsx1kPR7T"><div><span class="inline-wrap">这个不等式揭示了一个深刻的道理：一个模型最终的泛化表现</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>out</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Er}_\text{out}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">，其上限（右侧部分）是由它在训练集上的表现</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>in</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Er}_\text{in}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">和它所属的假设空间复杂度</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\mathcal{H})</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap"><b>共同决定</b></span><span class="inline-wrap">的。</span></div></div><div class="wolai-block wolai-text" id="ee3NgTUzwFips4E371Pt3r"><div><span class="inline-wrap">这就启发了一个非常自然的想法：既然我们的目标是让左侧的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>out</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Er}_\text{out}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">尽可能小，那么一个有效的策略就是去</span><span class="inline-wrap"><b>最小化其右侧的上界</b></span><span class="inline-wrap">。也就是说，我们的优化目标不应该仅仅是单纯地最小化</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>in</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Er}_\text{in}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">，而应该转变为</span><span class="inline-wrap"><b>同时最小化</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>in</mtext></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Er}_\text{in}(f)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap"><b>与</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\mathcal{H})</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap"><b> 这两项之和</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text" id="4sZYnGQ3fYsjHahvAeEDbp"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><msub><mtext>Er</mtext><mtext>in</mtext></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><mi mathvariant="script">H</mi><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\min \left( \text{Er}_\text{in}(f) +\Omega \left(\mathcal{H}\right) \right)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="gi8mzH8qP9FEGveJtNFMAT"><div><span class="inline-wrap">然而，这里存在一个从理论到实践的鸿沟：</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\mathcal{H})</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">衡量的是整个假设空间</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap"> 的复杂度（例如<span class="jill"></span>VC<span class="jill"></span>维），它是一个理论分析概念，我们很难将其作为一个具体的数值直接放进优化算法里。</span></div></div><div class="wolai-block wolai-text" id="itySEtfJznSuaJ55NFc7S2"><div><span class="inline-wrap">为了跨越这个鸿沟，正则化（Regularization）应运而生。它采用了一种巧妙且实用的</span><span class="inline-wrap"><b>启发式策略</b></span><span class="inline-wrap">：</span></div></div><ol class="wolai-block"><li id="f739iZ4U2rd5V3yU6XxteD"><div class="marker"></div><span class="inline-wrap">我们用一个</span><span class="inline-wrap"><b>可计算的</b></span><span class="inline-wrap">、针对</span><span class="inline-wrap"><b>单个模型</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="inline-wrap">的复杂度度量</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(f)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">（例如模型权重的范数），来</span><span class="inline-wrap"><b>替代</b></span><span class="inline-wrap">理论上那个</span><span class="inline-wrap"><b>不可计算的</b></span><span class="inline-wrap">、针对</span><span class="inline-wrap"><b>整个空间</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">的复杂度度量</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\mathcal{H})</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">。这个</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(f)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">就成了理论复杂度</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\mathcal{H})</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">在实践中的一个</span><span class="inline-wrap"><b>代理（Proxy）</b></span><span class="inline-wrap">。</span></li><li id="cwbQXiUX2TAWtvqM2qd9G4"><div class="marker"></div><span class="inline-wrap">我们依然从一个足够丰富和复杂的假设空间</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">出发，以确保算法有足够的能力找到一个较低的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Er</mtext><mtext>in</mtext></msub></mrow><annotation encoding="application/x-tex">\text{Er}_\text{in}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">。</span></li></ol><div class="wolai-block wolai-text" id="77QDCCB13ojF3ugBHSLenT"><div><span class="inline-wrap">通过这种方式，我们将那个源于理论的理想目标转化为了一个在工程上完全可行的优化问题：</span></div></div><div class="wolai-block wolai-text" id="24eY3mgLvG5gZKs98ZjXD6"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>f</mi><mo>∈</mo><mi mathvariant="script">H</mi></mrow></munder><msub><mtext>Er</mtext><mtext>in</mtext></msub><mrow><mo fence="true">(</mo><mi>f</mi><mo fence="true">)</mo></mrow><mo>+</mo><mi mathvariant="normal">Ω</mi><mrow><mo fence="true">(</mo><mi>f</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\min_{f\in \mathcal{H}} \text{Er}_\text{in}\left(f\right)+\Omega \left(f\right)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.6382em;vertical-align:-0.8882em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8882em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">Er</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="rSdTutaCPNPu2NCDEQDPZd"><div><span class="inline-wrap">这个表达式正是正则化的核心，它指导学习算法在庞大的假设空间中，寻找一个既能很好地拟合数据，又足够“简单”的优秀模型。</span></div></div><h3 class="wolai-block" id="ovbHzL5BHvTm7zGDc88mgD"><span class="inline-wrap"><b>L2<span class="jill"></span>和<span class="jill"></span>L1<span class="jill"></span>正则化</b></span></h3><div class="wolai-block wolai-text" id="cf18zyavpcpg9ZkmWT3uAz"><div><span class="inline-wrap"><b>L2<span class="jill"></span>正则化 (Ridge Regression)</b></span><span class="inline-wrap"> 是一种非常常用且有效的技术，它选择参数向量</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">θ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span></span></span></span></span><span class="inline-wrap">的</span><span class="inline-wrap"><b>L2<span class="jill"></span>范数的平方</b></span><span class="inline-wrap">作为复杂度的惩罚项：</span></div></div><div class="wolai-block wolai-text" id="pGf6bgP2xzx5LfwawmxmKL"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><msubsup><mi>θ</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\Omega(\boldsymbol{\theta})=\|\boldsymbol{\theta}\|_{2}^{2}=\sum_{i=1}^{d} \theta_{i}^{2}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1138em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="e46qguPNArPwy9fQGJ8Zxn"><div><span class="inline-wrap">与<span class="jill"></span>L2<span class="jill"></span>正则化惩罚参数的平方和不同，L1<span class="jill"></span>正则化惩罚的是参数的绝对值之和。对于一个参数向量<span class="jill"></span>θ∈Rd，其<span class="jill"></span>L1<span class="jill"></span>惩罚项定义为：</span></div></div><div class="wolai-block wolai-text" id="6bVrMzwxsS6KGvs4dFTZgP"><div><span class="inline-wrap">在讨论了<span class="jill"></span>L2<span class="jill"></span>正则化（Ridge<span class="jill"></span>回归）之后，我们引入另一种非常重要且广泛使用的正则化技术：</span><span class="inline-wrap"><b>L1<span class="jill"></span>正则化</b></span><span class="inline-wrap">。当<span class="jill"></span>L1<span class="jill"></span>正则化被应用于线性回归模型时，它被称为</span><span class="inline-wrap"><b>Lasso（Least Absolute Shrinkage and Selection Operator，最小绝对收缩和选择算子）</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text" id="eqVZRvuWfcZ5mEMiJMP8pU"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><mi mathvariant="normal">∣</mi><msub><mi>θ</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\Omega(\boldsymbol{\theta}) = \|\boldsymbol{\theta}\|_1 = \sum_{i=1}^d |\theta_i|</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1138em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></div><div class="wolai-block wolai-text" id="oBRmsGweupgbhji7XE3jXZ"><div><span class="inline-wrap">让我们通过经典的</span><span class="inline-wrap"><b>最小二乘法 (Least Squares)</b></span><span class="inline-wrap"> 来理解这一思想。在线性回归中，我们试图找到一个参数向量</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">θ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span></span></span></span></span><span class="inline-wrap">，使得模型的预测值</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{X} \boldsymbol{\theta}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span></span></span></span></span><span class="inline-wrap">与真实标签</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">y</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{y}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span></span></span></span></span><span class="inline-wrap">之间的平方误差最小：</span></div></div><div class="wolai-block wolai-text" id="qLXT5xc1BrEhezW5Etgk2N"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi mathvariant="bold-italic">θ</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow></munder><msubsup><mrow><mo fence="true">∥</mo><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><mo fence="true">∥</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\theta}}=\arg \min _{\boldsymbol{\theta} \in \mathbb{R}^{d}}\left\|\boldsymbol{X} \boldsymbol{\theta}-\boldsymbol{y}\right\|_{2}^{2}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7948em;vertical-align:-0.8408em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.2866em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathbb mtight">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8408em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mclose delimcenter" style="top:0em;">∥</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="3G6c46YMRL2SBAodrfVpcz"><div><span class="inline-wrap">其中，</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">X</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{X}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span></span></span></span></span><span class="inline-wrap">是一个</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">n\times d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span><span class="inline-wrap">的数据矩阵，代表</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span class="inline-wrap">个样本和</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span><span class="inline-wrap">个特征。</span></div></div><div class="wolai-block wolai-text" id="e8w1J6EVLuyayzz9YGP52f"><div><span class="inline-wrap">然而，当特征维度</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span><span class="inline-wrap">开始接近甚至超过样本数量</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span class="inline-wrap">时，问题就出现了。在这种高维场景下，模型具有极高的自由度，它能够轻易地找到一组参数，使得训练误差趋近于零。但这通常是一种“虚假”的拟合，模型学到的是训练数据的噪声而非潜在规律，导致其在测试数据上表现极差，这正是</span><span class="inline-wrap"><b>过拟合</b></span><span class="inline-wrap">的典型表现。</span></div></div><div class="wolai-block wolai-text" id="g7CqyVzn16cU2pq8nf9NSj"><div><span class="inline-wrap">为了解决这个问题，我们将<span class="jill"></span>L2<span class="jill"></span>惩罚项加入到最小二乘的目标函数中，我们便得到了</span><span class="inline-wrap"><b>L2<span class="jill"></span>正则化的最小二乘法</b></span><span class="inline-wrap">，通常也被称为</span><span class="inline-wrap"><b>岭回归 (Ridge Regression)</b></span><span class="inline-wrap">：</span></div></div><div class="wolai-block wolai-text" id="bnn74KtAQHmevdhiUPPoJz"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi mathvariant="bold-italic">θ</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow></munder><munder><munder><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy="true">⏟</mo></munder><mtext>误差项</mtext></munder><mo>+</mo><munder><munder><mrow><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy="true">⏟</mo></munder><mtext>正则化项</mtext></munder></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\theta}}=\arg\min_{{\boldsymbol{\theta}\in\mathbb{R}^{d}}}\underbrace{{\|\boldsymbol{X}\boldsymbol{\theta}-\boldsymbol{y}\|_{2}^{2}}}_{\text{误差项}}+\underbrace{{\lambda\|\boldsymbol{\theta}\|_{2}^{2}}}_{\text{正则化项}}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4404em;vertical-align:-1.5763em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.2866em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathbb mtight">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8408em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-1.4237em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">误差项</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMidYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMaxYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5763em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4404em;vertical-align:-1.5763em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-1.4237em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">正则化项</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMidYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMaxYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5763em;"><span></span></span></span></span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="way5GY4XYfymLNz8x8BTc1"><div><span class="inline-wrap">在这个新的目标函数中，</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda &gt;0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap">是一个</span><span class="inline-wrap"><b>正则化参数</b></span><span class="inline-wrap">，它是一个需要我们预先设定的</span><span class="inline-wrap"><b>超参数</b></span><span class="inline-wrap">。</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">的值至关重要，因为它控制了误差项和正则化项之间的权衡：</span></div></div><div class="wolai-block wolai-text" id="h5g4Z23x6XDc26Qcw1qti6"><div><span class="inline-wrap">将<span class="jill"></span>L1<span class="jill"></span>正则化项与线性回归的最小二乘损失函数结合，我们就得到了</span><span class="inline-wrap"><b>Lasso<span class="jill"></span>问题</b></span><span class="inline-wrap"> 的目标函数：</span></div></div><div class="wolai-block wolai-text" id="w6qyp8gDD7gb5Z48JDGQbh"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold-italic">θ</mi><mo>^</mo></mover><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi mathvariant="bold-italic">θ</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow></munder><munder><munder><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><mo stretchy="true">⏟</mo></munder><mtext>损失函数 (Loss)</mtext></munder><mo>+</mo><munder><munder><mrow><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><mo stretchy="true">⏟</mo></munder><mtext>L1正则化项</mtext></munder></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\theta}} = \arg\min_{\boldsymbol{\theta} \in \mathbb{R}^d} \underbrace{\|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2}_{\text{损失函数 (Loss)}} + \underbrace{\lambda\|\boldsymbol{\theta}\|_1}_{\text{L1正则化项}}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.9579em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6621em;vertical-align:-1.798em;"></span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.2866em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathbb mtight">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.782em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8408em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-1.377em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">损失函数</span><span class="mord mtight"> (Loss)</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMidYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMaxYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.798em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3263em;vertical-align:-1.5763em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-1.4237em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">L1</span><span class="mord cjk_fallback mtight">正则化项</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMidYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height:0.548em;"><svg height="0.548em" preserveaspectratio="xMaxYMin slice" viewbox="0 0 400000 548" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5763em;"><span></span></span></span></span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="8h5fg13MYsw5bpcgRbuS5g"><div><span class="inline-wrap">这个目标函数在两个方面对模型进行约束：</span></div></div><ul class="wolai-block"><li id="5qkBsYJuHizdss7PQ7v1Kv"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">第一项（损失函数）驱使模型去</span><span class="inline-wrap"><b>拟合训练数据</b></span><span class="inline-wrap">。</span></li><li id="jJDm6euBHpzCpvQ94dqfJx"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">第二项（L1<span class="jill"></span>正则化项）驱使模型选择一个</span><span class="inline-wrap"><b>稀疏的</b></span><span class="inline-wrap">参数解，即让尽可能多的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\theta_i</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap"> 为零。</span></li><li id="oTrUxUuBYw66FtW2dy3MnQ"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">超参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">控制着这两者之间的平衡。</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">越大，正则化惩罚越重，最终解的稀疏性就越强（即有越多的参数为零）。</span></li></ul><div class="wolai-block wolai-text" id="o3Mz752coQtvpfFizaqW63"><div><span class="inline-wrap">为了真正理解正则化是如何工作的，我们先通过几何图形来建立直观的感受。</span></div></div><div class="wolai-block wolai-text" id="3eeA9UxNQ3tA6g1J25Ns79"><div><span class="inline-wrap">我们可以从两个核心的几何视角来理解这个过程。</span></div></div><h3 class="wolai-block" id="6Dp62dmDns55ZQQyPTQ9Wo"><span class="inline-wrap"><b>视角一：两个函数的叠加</b></span></h3><div class="wolai-block wolai-text" id="eofERdqBSAP9VCPJNFTBfV"><div><span class="inline-wrap">回顾一下，L2<span class="jill"></span>正则化 (岭回归) 的目标函数是在最小化原始损失函数（以最小二乘误差为例）的同时，添加一个对模型参数<span class="jill"></span>L2<span class="jill"></span>范数的惩罚：</span></div></div><div class="wolai-block wolai-text" id="5PFvBkRQVvJmcw6CiNiMSx"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant="bold-italic">θ</mi></munder><mrow><mo fence="true">(</mo><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\min_{\boldsymbol{\theta}} \left( \|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2 + \lambda\|\boldsymbol{\theta}\|_2^2 \right)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.6162em;vertical-align:-0.7521em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7521em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="4i9wqA3GUTGerSPyEqFiXS"><div><span class="inline-wrap">L1<span class="jill"></span>正则化 (Lasso) 同理：</span></div></div><div class="wolai-block wolai-text" id="pTyErVvjJ9LZvcLDjz62VA"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant="bold-italic">θ</mi></munder><mrow><mo fence="true">(</mo><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\min_{\boldsymbol{\theta}} \left( \|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2 + \lambda\|\boldsymbol{\theta}\|_1 \right)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.6162em;vertical-align:-0.7521em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7521em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="hHjH7GaxYeZDbVvZSK7iN1"><div><span class="inline-wrap">在这个视角下，我们将目标函数看作是两个</span><span class="inline-wrap">“</span><span class="inline-wrap">独立函数”的叠加：</span></div></div><div class="wolai-block wolai-text" id="x4oBVXN57g7pHBk1BMCWt6"><div><span class="inline-wrap">对于<span class="jill"></span>L2<span class="jill"></span>正则化：</span></div></div><div class="wolai-block wolai-text" id="7fTpUsRpgMpwLGh9VXff46"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi mathvariant="script">L</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_1(\boldsymbol{\theta}) +\mathcal{L}_2(\boldsymbol{\theta})= \|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2 + \lambda\|\boldsymbol{\theta}\|_2^2 </annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="qmKvFRrFXsj1aF77ezxEzP"><div><span class="inline-wrap">对于<span class="jill"></span>L1<span class="jill"></span>正则化：</span></div></div><div class="wolai-block wolai-text" id="xs7p7jKU8uSbs9kyC1Tk47"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi mathvariant="script">L</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_1(\boldsymbol{\theta}) +\mathcal{L}_2(\boldsymbol{\theta})= \|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2 + \lambda\|\boldsymbol{\theta}\|_1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></div><div class="wolai-block wolai-text" id="dp47ptLgUR2cGKEp2zYHZH"><div><span class="inline-wrap">以</span><span class="inline-wrap"><b>二元函数</b></span><span class="inline-wrap">为例，整个优化过程就变成了在自变量参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\theta_1, \theta_2)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">构成的平面上，寻找组合后目标函数的最低点。</span></div></div><h4 class="wolai-block" id="htZFXG4L4nwGsC3fPJUyQZ"><span class="inline-wrap">最小二乘误差函数</span></h4><div class="wolai-block wolai-text" id="wo6ZnrBZagBGo1Ds8GkvFx"><div><span class="inline-wrap">无论是<span class="jill"></span>L1<span class="jill"></span>还是<span class="jill"></span>L2<span class="jill"></span>正则化，它们有同一个损失函数部分，即标准最小二乘（OLS）的误差</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_1(\boldsymbol{\theta})=\|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">。在三维空间中，这个函数形成一个</span><span class="inline-wrap"><b>抛物面“碗”的形状</b></span><span class="inline-wrap">。从正上方俯瞰，这个碗的等高线是一些</span><span class="inline-wrap"><b>椭圆形</b></span><span class="inline-wrap">的同心线。</span></div></div><div class="wolai-block wolai-text" id="n5288me26LzxPAwjNjvEc7"><div><span class="inline-wrap">它的</span><span class="inline-wrap"><b>最低点</b></span><span class="inline-wrap">，也就是碗底或椭圆的中心（图中</span><span class="red inline-wrap"><b>红色<span class="jill"></span>X</b></span><span class="inline-wrap">所示），代表了在没有任何正则化约束时，能够最佳拟合训练数据的参数解，我们称之为</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold-italic">θ</mi><mrow><mi>O</mi><mi>L</mi><mi>S</mi></mrow><mo>∗</mo></msubsup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}^*_{OLS}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.02em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.773em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">。</span></div></div><div class="wolai-block" id="cXBTmTNtyvLbSMABWhKXHi"><figure class="wolai-center" style="width: 312.2222098156263px; flex-direction: column"><img src="media/image.png" style="width: 100%"/></figure></div><h4 class="wolai-block" id="x335vhkuhox4Q1acQx64b9"><span class="inline-wrap">惩罚项形成的函数</span></h4><div class="wolai-block wolai-text" id="p9c4F5J5nfF79NyCUrSx8E"><div><span class="inline-wrap">L1<span class="jill"></span>和<span class="jill"></span>L2<span class="jill"></span>正则化的本质区别，体现在它们各自惩罚项所形成的函数上。</span></div></div><ul class="wolai-block"><li id="28pv62MZVxjZYZyJcna5ka"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>对于<span class="jill"></span>L2<span class="jill"></span>正则化</b></span><span class="inline-wrap">：</span><div class="wolai-block wolai-text" id="5MAwziT7E8qfJgdpdiZtqZ"><div><span class="inline-wrap">L2<span class="jill"></span>惩罚项函数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_2(\boldsymbol{\theta})=\lambda\|\boldsymbol{\theta}\|_2^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">（即</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\lambda(\theta_1 + \theta_2)^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">）构成一个以</span><span class="inline-wrap"><b>原点为中心</b></span><span class="inline-wrap">的、完美的</span><span class="inline-wrap"><b>圆形抛物面“碗”</b></span><span class="inline-wrap">。其等高线是标准的同心圆。它处处光滑，代表着一种均匀、平滑的向心“引力”。它的</span><span class="inline-wrap"><b>最低点</b></span><span class="inline-wrap">在原点（左图中</span><span class="blue inline-wrap"><b>蓝色<span class="jill"></span>X</b></span><span class="inline-wrap">所示），偏好让所有参数的绝对值都“小一点”。</span></div></div></li><li id="kNyq19h8oJeiK5wovRAugN"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>对于<span class="jill"></span>L1<span class="jill"></span>正则化</b></span><span class="inline-wrap">：</span><div class="wolai-block wolai-text" id="eMZkcjr8Pe3ugShuCE5hoF"><div><span class="inline-wrap">L1<span class="jill"></span>惩罚项函数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>λ</mi><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_2(\boldsymbol{\theta})=\lambda\|\boldsymbol{\theta}\|_1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">（即</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><msub><mi>θ</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\lambda(|\theta_1| + |\theta_2|)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">）则是一个由四个平面组成的、指向下方的</span><span class="inline-wrap"><b>倒金字塔形状</b></span><span class="inline-wrap">（或<span class="jill"></span>V<span class="jill"></span>形槽）。它的等高线是一个个</span><span class="inline-wrap"><b>菱形</b></span><span class="inline-wrap">。这个景观最显著的特征是，它在坐标轴上存在</span><span class="inline-wrap"><b>尖锐的“折痕”或“山谷”</b></span><span class="inline-wrap">。虽然它的</span><span class="inline-wrap"><b>最低点</b></span><span class="inline-wrap">也在原点（右图中</span><span class="blue inline-wrap"><b>蓝色<span class="jill"></span>X</b></span><span class="inline-wrap">所示），但它对解的吸引方式是“非均匀”的，沿着坐标轴的“山谷”方向吸引力最强，偏好让某些参数的值变成<span class="jill"></span>0。</span></div></div></li></ul><div class="wolai-block" id="vxiQGuu4EhAVifigmRJu7x"><figure class="wolai-center" style="width: 612.2221978946978px; flex-direction: column"><img src="media/image_1.png" style="width: 100%"/></figure></div><div class="wolai-block wolai-text" id="ecBH3UhJfbLVCZsXgxxXc8"><div><span class="inline-wrap">正则化的最终目标函数是上述两个函数的直接相加</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi mathvariant="script">L</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_1(\boldsymbol{\theta}) +\mathcal{L}_2(\boldsymbol{\theta})</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">。这意味着在参数平面的每一点，我们将两个函数的高度值相加，从而形成一个</span><span class="inline-wrap"><b>新的函数</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text" id="mEVooxcnB9NVBg1mgPZBf7"><div><span class="inline-wrap">合并后的函数的</span><span class="inline-wrap"><b>最低点</b></span><span class="inline-wrap">（图中</span><span class="orange inline-wrap"><b>黄色<span class="jill"></span>X</b></span><span class="inline-wrap">所示）就是我们最终求得的解</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold-italic">θ</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}^*</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.773em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.773em;"><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">。它既不是原始损失函数的最低点（</span><span class="red inline-wrap"><b>红色<span class="jill"></span>X</b></span><span class="inline-wrap">），也不是正则项偏好的原点（</span><span class="blue inline-wrap"><b>蓝色<span class="jill"></span>X</b></span><span class="inline-wrap">）。</span></div></div><div class="wolai-block" id="v5k7RHTStMCJKVXU9apBTa"><figure class="wolai-center" style="width: 626.6666417651716px; flex-direction: column"><img src="media/image_2.png" style="width: 100%"/></figure></div><div class="wolai-block wolai-text" id="sNmsxt9XBPKk1e6D7Rg2Rd"><div><span class="inline-wrap"><b>对于<span class="jill"></span>L2<span class="jill"></span>正则化</b></span><span class="inline-wrap">：</span></div></div><div class="wolai-block wolai-text" id="p1Du8N7xAWccQ1eMznL2iA"><div><span class="inline-wrap">将两个光滑的抛物面（一个椭圆，一个圆形）相加，会得到一个</span><span class="inline-wrap"><b>新的、依然光滑的抛物面</b></span><span class="inline-wrap">。其合并后的最低点（图中</span><span class="orange inline-wrap"><b>黄色<span class="jill"></span>X</b></span><span class="inline-wrap">所示）就是岭回归解</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold-italic">θ</mi><mtext>Ridge</mtext><mo>∗</mo></msubsup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}^*_\text{Ridge}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.1561em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.773em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Ridge</span></span></span></span><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">。这个解是两个“力”相互拉扯达到平衡的结果：</span></div></div><ul class="wolai-block"><li id="vjvxtyEAVTtHytfcJYPK7h"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">最小二乘法的</span><span class="inline-wrap"><b>损失函数</b></span><span class="inline-wrap">希望将解</span><span class="inline-wrap"><b>从原点拉向</b></span><span class="red inline-wrap"><b>红色<span class="jill"></span>X</b></span><span class="inline-wrap">。</span></li><li id="kGG5RZGhRNgH2H4jWYwZia"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>L2<span class="jill"></span>正则项</b></span><span class="inline-wrap">则平滑地将解</span><span class="inline-wrap"><b>从</b></span><span class="red inline-wrap"><b>红色<span class="jill"></span>X</b></span><span class="inline-wrap"><b>拉向原点</b></span><span class="inline-wrap">。</span></li></ul><div class="wolai-block wolai-text" id="tKbLz8ruPc4evceKybNmhS"><div><span class="inline-wrap">最终的解</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold-italic">θ</mi><mtext>Ridge</mtext><mo>∗</mo></msubsup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}^*_\text{Ridge}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.1561em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.773em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Ridge</span></span></span></span><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">就落在这两个点之间的某个位置（</span><span class="yellow inline-wrap"><b>黄色<span class="jill"></span>X</b></span><span class="inline-wrap">），实现了对所有参数的</span><span class="inline-wrap"><b>“收缩”（Shrinkage）</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block" id="cBaLfkj6U4MKZpC23wVzhS"><figure class="wolai-center" style="width: 497.77775799786684px; flex-direction: column"><img alt="机器学习-鸢尾花书系列 机器学习-鸢尾花书系列 " src="media/image_3.png" style="width: 100%"/><figcaption>机器学习-鸢尾花书系列</figcaption></figure></div><div class="wolai-block wolai-text" id="mE51HTsgcX2V1SfTdcgBsZ"><div><span class="inline-wrap"><b>对于<span class="jill"></span>L1<span class="jill"></span>正则化</b></span><span class="inline-wrap">：</span></div></div><div class="wolai-block wolai-text" id="dzS7A36Ltm758dkBbtDqTx"><div><span class="inline-wrap">将光滑的椭圆“碗”与带尖锐折痕的“倒金字塔”相加，会得到一个</span><span class="inline-wrap"><b>新的、同样带有折痕的曲面</b></span><span class="inline-wrap">。</span></div></div><ul class="wolai-block"><li id="obHcscvxTpnTd3VZe6fGJw"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">当<span class="jill"></span>OLS<span class="jill"></span>解（</span><span class="red inline-wrap"><b>红色<span class="jill"></span>X</b></span><span class="inline-wrap">）被这个“倒金字塔”向原点吸引时，由于坐标轴上存在“山谷”，解有极大的概率会“滑入”其中一个山谷（坐标轴上）。</span></li><li id="vLRNbihebo5AYjvTPJwYmf"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">“滑入山谷”意味着什么？如果解的最低点落在了</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\theta_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">轴这条“山谷”上，就意味着其</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\theta_1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">坐标为零。</span></li></ul><div class="wolai-block wolai-text" id="pPbmWUcBZciRW1Muxcq2Ef"><div><span class="inline-wrap">因此，最终的<span class="jill"></span>Lasso<span class="jill"></span>解</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold-italic">θ</mi><mtext>Lasso</mtext><mo>∗</mo></msubsup></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}^*_\text{Lasso}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.02em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.773em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">Lasso</span></span></span></span><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">常常落在某些坐标轴上，这导致了某些参数</span><span class="inline-wrap"><b>恰好为零</b></span><span class="inline-wrap">，即</span><span class="inline-wrap"><b>“稀疏性”（Sparsity）</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block" id="5B4T2SPg4c18J6VsAvYwKG"><figure class="wolai-center" style="width: 498.88886906482634px; flex-direction: column"><img alt="机器学习-鸢尾花书系列 机器学习-鸢尾花书系列 " src="media/image_4.png" style="width: 100%"/><figcaption>机器学习-鸢尾花书系列</figcaption></figure></div><h4 class="wolai-block" id="8FWaGqxCbAkXEEnAhwhMb9"><span class="inline-wrap">超参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">的作用</span></h4><div class="wolai-block wolai-text" id="vXvToqLYb7QAqKNu3mTLKv"><div><span class="inline-wrap">超参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">在这个叠加过程中扮演着“权重”的角色，它决定了正则项函数曲面的陡峭程度。</span></div></div><ul class="wolai-block"><li id="pt2mon6gazEw9z64XZLy17"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>对于<span class="jill"></span>L2<span class="jill"></span>正则化</b></span><span class="inline-wrap">：随着</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">增大，圆形碗变得越来越陡峭，其对原点的“引力”越来越强，迫使最终解（</span><span class="yellow inline-wrap"><b>黄色<span class="jill"></span>X</b></span><span class="inline-wrap">）沿着一条平滑的轨迹从</span><span class="red inline-wrap"><b>红色<span class="jill"></span>X</b></span><span class="inline-wrap">向</span><span class="inline-wrap"><b>原点</b></span><span class="inline-wrap">移动。</span></li><li id="cixHCL7b9B1QESAiikS73j"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>对于<span class="jill"></span>L1<span class="jill"></span>正则化</b></span><span class="inline-wrap">：随着</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">增大，“倒金字塔”变得越来越陡峭，坐标轴上的“山谷”也越来越深。这使得解更容易“滑入”并停留在某些坐标轴上，从而增强了模型的稀疏性。</span></li></ul><div class="wolai-block wolai-text" id="k3UQZ5b8aFBbhPcZuRQ9GV"><div><span class="inline-wrap">因此，通过调整</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">，我们可以在“完全相信数据”（OLS<span class="jill"></span>解）和“参数收缩”（或稀疏）这两个极端之间，灵活地控制模型的最终形态。</span></div></div><div class="wolai-block wolai-text" id="p47apj8sppJttm9dCKpFEV"><div><span class="inline-wrap">下面的动画展示了随着正则化参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">不断增大，最优解（</span><span class="yellow inline-wrap"><b>黄色<span class="jill"></span>X</b></span><span class="inline-wrap">）位置的变化。左图对应</span><span class="inline-wrap"><b>L2<span class="jill"></span>正则化</b></span><span class="inline-wrap">，右图对应</span><span class="inline-wrap"><b>L1<span class="jill"></span>正则化</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-row" id="8e2zKi5Rnaq76bf772deoX"><div class="wolai-col" id="uNWXcnxkTFitZiMARJ516G" style="flex-grow: 0.5"><div class="wolai-block" id="ewn564ZHQrq4JyvYnGdm6H"><figure class="wolai-right" style="width: 201.11110311967386px; flex-direction: column"><img src="media/pixpin_2025-10-20_21-57-44.gif" style="width: 100%"/></figure></div></div><div class="wolai-col" id="3J8SXvU7DMRwQLPXS7zPeC" style="flex-grow: 0.5"><div class="wolai-block" id="5gnkNwiNh9Tayigy2YTUB6"><figure class="wolai-left" style="width: 201.11110311967386px; flex-direction: column"><img src="media/pixpin_2025-10-20_22-00-19.gif" style="width: 100%"/></figure></div></div></div><div class="wolai-block wolai-text" id="iiHTrGm22sxu84rSHGvD9X"><div><span class="inline-wrap">因此，从函数叠加的视角看，L2<span class="jill"></span>正则化像一个光滑的引力场，将解均匀地拉向原点，实现</span><span class="inline-wrap"><b>参数收缩</b></span><span class="inline-wrap">；而<span class="jill"></span>L1<span class="jill"></span>正则化则像一个带有特定路径（坐标轴上的“山谷”）的引力场，倾向于将解“拽”到坐标轴上，从而实现</span><span class="inline-wrap"><b>稀疏化和特征选择</b></span><span class="inline-wrap">。</span></div></div><h3 class="wolai-block" id="5SpLXegGQrBqQV7zvHHhro"><span class="inline-wrap"><b>视角二：约束区域的不同</b></span></h3><div class="wolai-block wolai-text" id="SG4HYZYEv7WBfAkUe5jeM"><div><span class="inline-wrap">除了将正则化看作是两个函数的叠加，我们还可以从一个等价的、带约束的优化视角来理解它。这个视角对于解释<span class="jill"></span>L1<span class="jill"></span>和<span class="jill"></span>L2<span class="jill"></span>正则化之间的本质区别尤为重要。</span></div></div><div class="wolai-block wolai-text" id="jvmj9dMeeQ1RgjbvheBCXq"><div><span class="inline-wrap">这种观点将<span class="jill"></span>L2<span class="jill"></span>正则化（岭回归）问题重新表述为：</span></div></div><div class="wolai-block wolai-text" id="xe8Dag4zAxnL3KFwWGDZn3"><div><span class="inline-wrap">在参数的<span class="jill"></span>L2<span class="jill"></span>范数平方</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\|\boldsymbol{\theta}\|_2^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">不超过某个预算值</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">的前提下，找到使原始损失函数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">最小化的参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">θ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span></span></span></span></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text" id="vriMbVo6BbcT86YK1TpXxx"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant="bold-italic">θ</mi></munder><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mspace width="1em"></mspace><mtext>subject to</mtext><mspace width="1em"></mspace><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>≤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\min_{\boldsymbol{\theta}} \|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2 \quad \text{subject to} \quad \|\boldsymbol{\theta}\|_2^2 \le c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.5021em;vertical-align:-0.7521em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7521em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">subject to</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span></div><div class="wolai-block wolai-text" id="iBVSVPyRw583NA8mVqgUAb"><div><span class="inline-wrap">同理，对于<span class="jill"></span>L1<span class="jill"></span>正则化：</span></div></div><div class="wolai-block wolai-text" id="mnWSKfKKR7WPWfY7iYqDfn"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant="bold-italic">θ</mi></munder><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mspace width="1em"></mspace><mtext>subject to</mtext><mspace width="1em"></mspace><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub><mo>≤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\min_{\boldsymbol{\theta}} \|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2 \quad \text{subject to} \quad \|\boldsymbol{\theta}\|_1 \le c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.5021em;vertical-align:-0.7521em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-2.3479em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03194em;">θ</span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7521em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">subject to</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span></div><div class="wolai-block wolai-text" id="8GJPgkotZrq9ekiU2wetHm"><div><span class="inline-wrap">这里的预算</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">与我们之前讨论的正则化强度</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">是反相关的关系：</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">越大，约束越强，允许的预算</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap"> 就越小。</span></div></div><div class="wolai-block wolai-text" id="jp1hXz83U6cvVQ1Y6iWSdE"><div><span class="inline-wrap">L1<span class="jill"></span>和<span class="jill"></span>L2<span class="jill"></span>正则化的核心差异，在几何上就体现在它们所定义的“可行域”形状完全不同。</span></div></div><h4 class="wolai-block" id="876Xx6uw3kfTVKmkggEyh6"><span class="inline-wrap"><b>L2<span class="jill"></span>的圆形约束域</b></span></h4><div class="wolai-block wolai-text" id="mwz4JjqhT99g5uSzgQy2KQ"><div><span class="inline-wrap">在</span><span class="inline-wrap"><b>二维</b></span><span class="inline-wrap">参数空间</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\theta_1, \theta_2)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">中，约束条件</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo>≤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\|\boldsymbol{\theta}\|_2^2 \le c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">（即</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>θ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>θ</mi><mn>2</mn><mn>2</mn></msubsup><mo>≤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\theta_1^2 + \theta_2^2 \le c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">）定义了一个以原点为中心、半径为</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>c</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{c}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.2397em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8203em;"><span class="svg-align" style="top:-3.01em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">c</span></span></span><span style="top:-2.7703em;"><span class="pstrut" style="height:3.01em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.09em;"><svg height="1.09em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1090" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M95,712
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l4.819277108433735 -10.000000000000002
c5.3,-9.3,12,-14,20,-14
H400000v50H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M844 80h400000v50h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">的</span><span class="inline-wrap"><b>圆形</b></span><span class="inline-wrap"><b>约束域</b></span><span class="inline-wrap"><b> (Circular Constraint)</b></span><span class="inline-wrap">。这意味着，我们寻找的最优解必须落在这个圆形可行域之内或其边界上。</span></div></div><div class="wolai-block" id="cwiLuRLEupFBNc9BBpWxdt"><figure class="wolai-center" style="width: 324.9999870856608px; flex-direction: column"><img alt="机器学习-鸢尾花书系列 机器学习-鸢尾花书系列 " src="media/image_5.png" style="width: 100%"/><figcaption>机器学习-鸢尾花书系列</figcaption></figure></div><div class="wolai-block wolai-text" id="x1dnMrNBNfcAaGtDtXFR8G"><div><span class="inline-wrap">由于我们既希望</span><span class="inline-wrap"><b>解在</b></span><span class="blue inline-wrap"><b>圆形区域</b></span><span class="inline-wrap"><b>内</b></span><span class="inline-wrap">，满足</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>θ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>θ</mi><mn>2</mn><mn>2</mn></msubsup><mo>≤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\theta_1^2 + \theta_2^2 \le c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">，又希望损失函数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">X</mi><mi mathvariant="bold-italic">θ</mi><mo>−</mo><mi mathvariant="bold-italic">y</mi><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\|\boldsymbol{X}\boldsymbol{\theta} - \boldsymbol{y}\|_2^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">X</span></span></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03704em;">y</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">的值最小，因此，优化的过程可以想象成：从损失函数的最小值点（</span><span class="red inline-wrap"><b>红色<span class="jill"></span>X</b></span><span class="inline-wrap">，即<span class="jill"></span>OLS<span class="jill"></span>解）开始，一圈圈“膨胀”其椭圆形的等高线，直到有一条等高线首次与这个圆形区域</span><span class="inline-wrap"><b>相切</b></span><span class="inline-wrap">。这个</span><span class="inline-wrap"><b>切点</b></span><span class="inline-wrap">，就是岭回归的最终解（</span><span class="inline-wrap"><b>Ridge solution</b></span><span class="inline-wrap">）。</span></div></div><div class="wolai-block wolai-text" id="hW8ujHSVfx5zWYXyLr6xqT"><div><span class="inline-wrap">在切点处，损失函数的梯度方向（图中红色箭头，垂直于等高线）与圆形区域的半径方向（从原点指向切点的向量）是平行的。这是约束优化问题取得最优解的数学特征。</span></div></div><div class="wolai-block" id="e7KX8441sBHwLgdWBxqhyp"><figure class="wolai-center" style="width: 675.5555287113907px; flex-direction: column"><img alt="机器学习-鸢尾花书系列 机器学习-鸢尾花书系列 " src="media/image_6.png" style="width: 100%"/><figcaption>机器学习-鸢尾花书系列</figcaption></figure></div><div class="wolai-block wolai-text" id="paSCt6Gf65poNkUaRf81EA"><div><span class="inline-wrap">圆形约束区域的大小，由预算</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">决定，直接影响着最终解的位置。</span></div></div><ul class="wolai-block"><li id="aEsLN35gsYekiYqGXwmJwN"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">当</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">很小（左一图），圆形区域很小，约束非常强。解被“囚禁”在离原点很近的地方，这对应于一个很大的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">值，可能导致欠拟合。</span></li><li id="u1eJ5hYJJCRQytvtJeQHKF"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">随着</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">逐渐增大（中间两图），圆形区域扩大，约束放宽。解被允许向<span class="jill"></span>OLS<span class="jill"></span>解（红色<span class="jill"></span>X）的方向移动，从而在拟合数据和模型简洁性之间找到更好的平衡。</span></li><li id="6MLyTUpLZ4L1pxQY2XkoX"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">当</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">足够大（右一图），以至于圆形区域已经包含了<span class="jill"></span>OLS<span class="jill"></span>解时，约束不再起作用。此时，最优解就是<span class="jill"></span>OLS<span class="jill"></span>解本身，这对应于</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda=0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap">的情况。</span></li></ul><div class="wolai-block wolai-text" id="81seGR9GzMe82hTkhgSLnL"><div><span class="inline-wrap">总的来说，从约束区域的视角看，L2<span class="jill"></span>正则化将解限制在一个光滑的圆形（或球形）空间内。这使得所有参数都会被同等地向原点“收缩”（Shrinkage）。</span></div></div><h4 class="wolai-block" id="6WCJBAK3yjG3iNVaqz5AQK"><span class="inline-wrap"><b>L1<span class="jill"></span>的菱形约束域</b></span></h4><div class="wolai-block wolai-text" id="xojPpYUMSxAkDPMPWCAsDJ"><div><span class="inline-wrap">与<span class="jill"></span>L2<span class="jill"></span>不同，L1<span class="jill"></span>的约束条件</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">θ</mi><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub><mo>≤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">\|\boldsymbol{\theta}\|_1 \le c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">（即</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mo>+</mo><mi mathvariant="normal">∣</mi><msub><mi>θ</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mo>≤</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">|\theta_1| + |\theta_2| \le c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">）在二维参数空间中定义的是一个</span><span class="inline-wrap"><b>菱形</b></span><span class="inline-wrap"><b>约束域 (Diamond Constraint)</b></span><span class="inline-wrap">（旋转了<span class="jill"></span>45<span class="jill"></span>度的正方形）。</span></div></div><div class="wolai-block wolai-text" id="7uVwScqergv4geAH2KCcs7"><div><span class="inline-wrap">这个菱形区域最关键的特征是它具有</span><span class="inline-wrap"><b>尖锐的顶点（corners）</b></span><span class="inline-wrap">，并且这些顶点恰好都位于坐标轴上。</span></div></div><div class="wolai-block" id="b465bp26CUMDWU75s4M5BJ"><figure class="wolai-center" style="width: 506.11109100006325px; flex-direction: column"><img src="media/image_7.png" style="width: 100%"/></figure></div><div class="wolai-block wolai-text" id="pVDfgjE5XZVC1CfPyWEVU1"><div><span class="inline-wrap">当损失函数的椭圆等高线从中心（</span><span class="red inline-wrap">红色<span class="jill"></span>X</span><span class="inline-wrap">）开始扩展时，由于菱形顶点的“突出”特性，等高线有极大的概率会首先与其中一个</span><span class="inline-wrap"><b>顶点</b></span><span class="inline-wrap">相交。</span></div></div><div class="wolai-block wolai-text" id="3seCgQLEn4Lx9zow3ky3Kj"><div><span class="inline-wrap">如果解恰好落在一个顶点上，例如图中的解落在了</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\theta_2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">轴上，那么这个点的坐标就是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(0, \theta_2)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">。这意味着，参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\theta_1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">的值</span><span class="inline-wrap"><b>恰好为零</b></span><span class="inline-wrap">！这正是<span class="jill"></span>L1<span class="jill"></span>正则化能够产生</span><span class="inline-wrap"><b>稀疏解（Sparse Solution）</b></span><span class="inline-wrap">并实现特征选择的几何本质。</span></div></div><div class="wolai-block" id="uRPvdKdDCDqcTuKzVHiAoM"><figure class="wolai-center" style="width: 668.8888623096335px; flex-direction: column"><img src="media/image_8.png" style="width: 100%"/></figure></div><div class="wolai-block wolai-text" id="f8TNz9EXAPf5qKacDFpWAg"><div><span class="inline-wrap">对于<span class="jill"></span>L1<span class="jill"></span>正则化，上图展示了随着预算</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex"> c </annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">增大，菱形区域不断扩大的过程。</span></div></div><ul class="wolai-block"><li id="sLq5hWQ1UtKk7zFPQQqNkH"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">当</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">很小（左一图），菱形区域很小，约束极强，解可能被压缩在离原点很近的顶点上，导致模型非常稀疏。</span></li><li id="ntvdam73SaQebv54yVKNmQ"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">随着</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">增大（中间两图），菱形区域扩大，解可以沿着坐标轴移动到离原点更远的位置，或者在某些情况下，当椭圆等高线的形状比较特别时，解也可能出现在菱形的边上（图中红色箭头，垂直于等高线。此时解不稀疏）。</span></li><li id="3tb4LUKe1DYasED44JX1SC"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">当</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span class="inline-wrap">足够大（右一图），菱形区域包含了<span class="jill"></span>OLS<span class="jill"></span>解，约束失效，解就是<span class="jill"></span>OLS<span class="jill"></span>解，模型不再稀疏。</span></li></ul><div class="wolai-block wolai-text" id="iNvuRQyQS5C1CALX1zENjv"><div><span class="inline-wrap"><b>总结</b></span><span class="inline-wrap">：从约束区域的视角看，两种正则化方法通过不同形状的“可行域”来约束解的范围。L2<span class="jill"></span>光滑的</span><span class="inline-wrap"><b>圆形</b></span><span class="inline-wrap">边界导致解被均匀地“收缩”；而<span class="jill"></span>L1<span class="jill"></span>尖锐的</span><span class="inline-wrap"><b>菱形</b></span><span class="inline-wrap">边界，特别是其位于坐标轴上的顶点，极大地增加了最优解中某些参数恰好为零的概率，从而实现了</span><span class="inline-wrap"><b>稀疏化</b></span><span class="inline-wrap">和</span><span class="inline-wrap"><b>特征选择</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-row" id="fN116M2vJpKE61MV7kgjJf"><div class="wolai-col" id="bUijutJ4hDnMPtFfowhRts" style="flex-grow: 0.5"><div class="wolai-block" id="9QbWoVq6kjdMR8kuTzsRYw"><figure class="wolai-right" style="width: 277.77776673988103px; flex-direction: column"><img alt="Stanford CS 229 Stanford CS 229 " src="media/ridge.png" style="width: 100%"/><figcaption>Stanford CS 229</figcaption></figure></div></div><div class="wolai-col" id="4Ht143w8dL5dGtYWaNcUdY" style="flex-grow: 0.5"><div class="wolai-block" id="xjGKikRiPZUHjcqNutkoHh"><figure class="wolai-left" style="width: 277.77776673988103px; flex-direction: column"><img alt="Stanford CS 229 Stanford CS 229 " src="media/lasso.png" style="width: 100%"/><figcaption>Stanford CS 229</figcaption></figure></div></div></div><h2 class="wolai-block" id="4TfDHAxVmsvLQSn4kRtfni"><span class="inline-wrap">正则化的哲学</span></h2><div class="wolai-block wolai-text" id="9e9Zm1SmN5hXmKvr6nW7eY"><div><span class="inline-wrap">首先，我们回顾一下正则化的核心思想。它采取的是一种“先放开，后收紧”的策略：</span></div></div><ol class="wolai-block"><li id="jvsnNFkdPNsMLbJBFxbS2V"><div class="marker"></div><span class="inline-wrap"><b>“放开” (Release)</b></span><span class="inline-wrap">：我们允许自己使用一个</span><span class="inline-wrap"><b>足够复杂的模型</b></span><span class="inline-wrap">（例如高阶多项式、大型神经网络）。这样做的好处是保证了模型有足够高的“上限”，有能力捕捉数据中可能存在的复杂模式，从而获得较低的训练误差（In-Sample Error）。</span></li><li id="pRU9wGjgrf6ByzpNBYMdbZ"><div class="marker"></div><span class="inline-wrap"><b>“收紧” (Penalize)</b></span><span class="inline-wrap">：接着，我们在目标函数中加入一个惩罚项</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\boldsymbol{\theta})</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03194em;">θ</span></span></span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">，这个惩罚项会抑制模型的复杂度。通过调整惩罚的强度，我们可以将模型的实际复杂度“拉回”到一个合适的水平，从而获得一个泛化能力强的“正确拟合”模型。</span></li></ol><h3 class="wolai-block" id="kj3KEVvLcZuXroGyxELpKG"><span class="inline-wrap">正则化的实践要点</span></h3><div class="wolai-block wolai-text" id="swpAuTuXsgbYSuaRfCAeZX"><div><span class="inline-wrap">在此基础上，有几个关键的实践要点需要理解：</span></div></div><ul class="wolai-block"><li id="3rNUauZ3NNbwn3w1gSMWJd"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>正则化是一种启发式方法 (Heuristic)</b></span><span class="inline-wrap">：理论（如<span class="jill"></span>VC<span class="jill"></span>理论）告诉我们控制模型空间复杂度 (</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">) 的重要性，但在实践中，我们无法精确计算或找到一个“完美”的惩罚函数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi></mrow><annotation encoding="application/x-tex">\Omega</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Ω</span></span></span></span></span><span class="inline-wrap">。像我们之前讨论的<span class="jill"></span>L1<span class="jill"></span>和<span class="jill"></span>L2<span class="jill"></span>范数，是经过长期实践检验、在众多应用中表现出色的有效方法，但它们本质上是一种实用的、基于经验的工程选择。</span></li><li id="ftYekQFiaMkzqMcrue6nvu"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>L2<span class="jill"></span>正则化的广泛应用</b></span><span class="inline-wrap">：在深度学习领域，L2<span class="jill"></span>正则化是迄今为止最常用、最基础的正则化技术，它通常被称为</span><span class="inline-wrap"><b>“权重衰减”（Weight Decay）</b></span><span class="inline-wrap">。这是因为在梯度下降的更新步骤中，L2<span class="jill"></span>惩罚项的梯度项会使得权重在每次更新时都朝着零的方向进行小幅度的“衰减”，从而有效防止权重变得过大。</span></li><li id="4R6DnRiP7RitENm4xmAzTx"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>正则化强度的权衡 (</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap"><b>)</b></span><span class="inline-wrap">：正则化并非越多越好。惩罚的强度由超参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">控制，</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap"> 的选择直接决定了模型的最终状态：</span><ul class="wolai-block"><li id="fxWMiRE2xrEXnvMhAftWjU"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap"><b> 过大</b></span><span class="inline-wrap">：惩罚过强，为了让惩罚项足够小，算法会极度压缩模型的参数（例如，所有权重都趋近于零）。这会导致模型过于简单，无法捕捉数据中的基本规律，造成</span><span class="inline-wrap"><b>欠拟合（Underfitting）</b></span><span class="inline-wrap">。此时模型具有高偏差（High Bias）。</span></li><li id="dF7qpKcs79xu5ksdabsaKY"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap"><b>过小 (包括</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda=0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap"><b>)</b></span><span class="inline-wrap">：惩罚过弱或没有惩罚，复杂的模型就会“放飞自我”，不仅学习了数据中的真实规律，还学习了数据中的噪声和随机波动，造成</span><span class="inline-wrap"><b>过拟合（Overfitting）</b></span><span class="inline-wrap">。此时模型具有高方差（High Variance）。</span></li></ul></li></ul><h4 class="wolai-block" id="mEj6D6V3os9gF32x4znJtB"><span class="inline-wrap">不同正则化水平的影响
</span></h4><div class="wolai-block wolai-text" id="qek4DNbA5d447xEVx51UsK"><div><span class="inline-wrap">以下图为例，数据实际上是由一个</span><span class="inline-wrap"><b>二次函数（Quadratic）</b></span><span class="inline-wrap">生成的（图中的</span><span class="inline-wrap"><code>target function</code></span><span class="inline-wrap">，红色虚线）。我们试图用一个</span><span class="inline-wrap"><b>十次多项式（10-th order polynomial）</b></span><span class="inline-wrap">去拟合这些数据。这个模型拥有<span class="jill"></span>11<span class="jill"></span>个参数，能力远超捕捉二次函数规律所需。</span></div></div><div class="wolai-block wolai-text" id="jtsf2CgzaF3R6j5sCEwH4G"><div><span class="inline-wrap">我们只有很少的几个数据点（</span><span class="inline-wrap"><code>data</code></span><span class="inline-wrap">，蓝色点），并且这些点并非完美地落在二次函数曲线上。</span></div></div><div class="wolai-block" id="cx8nxBEB2WQuP7T6ydqrTp"><figure class="wolai-center" style="width: 363.88887442924414px; flex-direction: column"><img src="media/image_9.png" style="width: 100%"/></figure></div><div class="wolai-block" id="4Q479twehQYEBfzsoLjnG5"><figure class="wolai-center" style="width: 100%; flex-direction: column"><img src="media/image_10.png" style="width: 100%"/></figure></div><ul class="wolai-block"><li id="4fWBoXCoqAkewXtzG6X7YW"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda = 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap"><b> (无正则化)</b></span><span class="inline-wrap"> ：拟合出的曲线（</span><span class="inline-wrap"><code>fitted curve</code></span><span class="inline-wrap">，橙色实线）剧烈地扭动，试图穿过每一个数据点。这会发生</span><span class="inline-wrap"><b>严重过拟合</b></span><span class="inline-wrap">。十次多项式模型动用了它的全部“法力”，不仅学习了数据背后简单的二次函数趋势，更是把每一个数据点的随机噪声也当成了“真实规律”去拟合。这条曲线在训练点上表现完美，但其泛化能力会极差，对新数据点的预测会错得离谱。</span></li><li id="sMPWPF1wAqPfkaoET59iJz"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.1</span></span></span></span></span><span class="inline-wrap"><b> (引入并增强正则化)</b></span><span class="inline-wrap"> ：随着</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">的增大，橙色曲线迅速变得平滑。它不再执着于穿过每一个数据点，而是开始寻找一条能够代表整体趋势的、更简洁的曲线。L2<span class="jill"></span>正则化开始发挥作用。它惩罚了大的权重系数，特别是那些高次项（如</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>10</mn></msup><mo separator="true">,</mo><msup><mi>x</mi><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">x^{10}, x^9</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.0085em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">）的系数。为了最小化“损失<span class="jill"></span>+<span class="jill"></span>惩罚”这个总目标，算法发现，牺牲一点点数据拟合的精度，来换取权重系数的大幅减小是值得的。这有效地“驯服”了复杂的十次多项式。</span></li><li id="hry4QRMDJKxbG3mwRsGdnA"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\lambda = 0.8</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.8</span></span></span></span></span><span class="inline-wrap"><b> (合适的正则化)</b></span><span class="inline-wrap"> ：此时的橙色曲线看起来非常接近真实的二次函数曲线。这可能是一个接近“最佳点”的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">值。正则化的强度恰到好处，它成功地抑制了由模型过剩复杂度所导致的过拟合，使得模型忽略了噪声，发现了数据背后真实的二次规律。这是</span><span class="inline-wrap"><b>偏差-方差权衡 (Bias-Variance Tradeoff)</b></span><span class="inline-wrap"> 的一个理想状态。</span></li><li id="iiBctpdJgueZkQCbssDCJr"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>2</mn><mo separator="true">,</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\lambda = 2, 10</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">10</span></span></span></span></span><span class="inline-wrap"><b> (过强的正则化)</b></span><span class="inline-wrap"> ：橙色曲线变得过于平坦，甚至比二次函数还要简单，开始偏离大部分数据点。这是典型的</span><span class="inline-wrap"><b>欠拟合</b></span><span class="inline-wrap">。由于</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">值过大，正则化惩罚在总目标函数中占据了主导地位。为了让权重尽可能小，模型被迫选择一个极其简单的形式（几乎是一条直线），代价是无法很好地拟一合数据。模型“矫枉过正”，变得过于简单，连数据本身的基本趋势都无法捕捉。</span></li></ul><h4 class="wolai-block" id="eJMM2n2u7kKrQuvp5n1ZT8"><span class="inline-wrap">正则化与<span class="jill"></span>VC<span class="jill"></span>维的联系</span></h4><div class="wolai-block wolai-text" id="356p9mNHcTCLSkHQtRBgmZ"><div><span class="inline-wrap">在这里，我们在正则化操作与学习理论中的<span class="jill"></span>VC<span class="jill"></span>维之间建立一座桥梁，以解释为什么正则化能提高泛化能力。</span></div></div><ol class="wolai-block"><li id="bGWysUThpGQBPD51BaAXnz"><div class="marker"></div><span class="inline-wrap"><b>VC<span class="jill"></span>维与假设空间</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">：首先要明确，VC<span class="jill"></span>维是</span><span class="inline-wrap"><b>假设空间</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">的一个固有属性。例如，所有</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span><span class="inline-wrap">维线性模型的集合，其<span class="jill"></span>VC<span class="jill"></span>维就是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span class="inline-wrap">。无论我们后续的算法如何改变，这个集合本身是不变的，因此它的<span class="jill"></span>VC<span class="jill"></span>维也不会变。</span></li><li id="4RRa1mbrVsGEs3amysEuWW"><div class="marker"></div><span class="inline-wrap"><b>正则化的作用对象</b></span><span class="inline-wrap">：正则化参数</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">的改变，并</span><span class="inline-wrap"><b>没有改变假设空间</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">。它改变的是</span><span class="inline-wrap"><b>学习算法</b></span><span class="inline-wrap">。算法依然在同一个巨大的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">空间里搜索解，但是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">的存在使得算法对解产生了强烈的“偏好”——它更偏爱那些复杂度惩罚项</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(f)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">很小的解（例如，权重范数小的解）。</span></li><li id="dzqS7PJ4dvyRqf3EtAbMK7"><div class="marker"></div><span class="inline-wrap"><b>“有效<span class="jill"></span>VC<span class="jill"></span>维”的启发式概念</b></span><span class="inline-wrap">：为了将算法的这种“偏好”与<span class="jill"></span>VC<span class="jill"></span>理论联系起来，我们引入一个启发式的概念——</span><span class="inline-wrap"><b>有效<span class="jill"></span>VC<span class="jill"></span>维</b></span><span class="inline-wrap">。</span><ul class="wolai-block"><li id="gTvACBBFspbHaa1FQxgFp8"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>理解</b></span><span class="inline-wrap">：尽管我们允许算法在整个高<span class="jill"></span>VC<span class="jill"></span>维的空间</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">中寻找模型，但正则化的强大约束力，使得算法实际上只会在一个</span><span class="inline-wrap"><b>复杂度更低的“有效子集”</b></span><span class="inline-wrap">中进行选择。这个“有效子集”的复杂度，就可以用所谓的“有效<span class="jill"></span>VC<span class="jill"></span>维”来衡量。</span></li><li id="ddDTdfHQc6F6iiBvraZ5MS"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>以<span class="jill"></span>L1<span class="jill"></span>正则化为例</b></span><span class="inline-wrap">：L1<span class="jill"></span>正则化会产生稀疏解（很多参数为零）。一个拥有</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span><span class="inline-wrap">个参数的线性模型，如果最终只有</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="inline-wrap">(</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&lt;</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">k &lt; d</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></span><span class="inline-wrap">) 个参数非零，那么它的行为就更像一个</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="inline-wrap">维的线性模型。因此，我们可以认为它的“有效<span class="jill"></span>VC<span class="jill"></span>维”从</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span class="inline-wrap">降低到了接近</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span class="inline-wrap">的水平。</span></li></ul></li></ol><div class="wolai-block wolai-text" id="6Nqn85taURvYpffzcSNiHK"><div><span class="inline-wrap">因此，正则化之所以能带来更好的泛化能力，其深层原因在于：</span></div></div><div class="wolai-block wolai-text" id="4jcyBneQKeQ84hGjtezZTC"><div><span class="orange inline-wrap"><b>虽然我们出发时选择的假设空间</b></span><span class="orange"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="orange inline-wrap"><b>可能非常大且复杂（VC<span class="jill"></span>维很高），但正则化项</b></span><span class="orange"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\lambda\Omega(f)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span></span><span class="orange inline-wrap"><b>作为一个“导航员”，引导学习算法在这个巨大的空间中，倾向于去寻找那些更简单、复杂度更低的解</b></span><span class="orange"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="orange inline-wrap"><b>。</b></span></div></div><div class="wolai-block wolai-text" id="umSM7PLxgBVRAdnH7FPwwi"><div><span class="inline-wrap">最终得到的模型</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="inline-wrap">，虽然来自一个高<span class="jill"></span>VC<span class="jill"></span>维的空间，但其自身的“有效复杂度”却很低，从而根据<span class="jill"></span>VC<span class="jill"></span>理论，它能够拥有更好的泛-化保证。正则化项</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\lambda\Omega(f)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">可以被看作是理论泛化界中那个抽象的复杂度项</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Ω</mi><mo stretchy="false">(</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Omega(\mathcal{H})</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Ω</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose">)</span></span></span></span></span><span class="inline-wrap">的一个可操作、可优化的</span><span class="inline-wrap"><b>实践代理</b></span><span class="inline-wrap">。</span></div></div><h3 class="wolai-block" id="qMg2Urhqfav4ABquFNojLQ"><span class="inline-wrap"><b>正则化</b></span><span class="inline-wrap">的作用</span></h3><h4 class="wolai-block" id="wqqi9JnGcsXrittCHMAXDk"><span class="inline-wrap"><b>正则化是对抗过拟合的良药</b></span></h4><div class="wolai-block wolai-text" id="rjd7R2fYqL7vTUfCu5LckD"><div><span class="inline-wrap">下图展示了正则化（在此处通过权重衰减实现）是如何缓解过拟合的。</span></div></div><div class="wolai-block" id="iCHqgFrzAkrBqf26CsAtd1"><figure class="wolai-center" style="width: 434.9999827146537px; flex-direction: column"><img src="media/image_11.png" style="width: 100%"/></figure></div><div class="wolai-block wolai-text" id="97sobRqG95pUnACh2dfLqB"><div><span class="inline-wrap"><b>左图：</b></span><span class="inline-wrap">我们使用一个高自由度的模型（四阶多项式）来拟合少数几个数据点。</span></div></div><ul class="wolai-block"><li id="oVqseoT7QYNJA6j772zyP2"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>现象</b></span><span class="inline-wrap">：为了最小化训练误差，模型会竭尽所能地穿过每一个数据点。这导致拟合出的曲线（蓝色线条）产生了剧烈的、不自然的弯曲和振荡。</span></li><li id="sg5gfbcFUv9eDnfcpKdqzm"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>问题</b></span><span class="inline-wrap">：这就是典型的</span><span class="inline-wrap"><b>过拟合</b></span><span class="inline-wrap">。模型学习到了训练数据中的噪声，而不是其内在的趋势。虽然它在已知数据点上表现完美，但其对于新数据的预测能力会非常差。</span></li></ul><div class="wolai-block wolai-text" id="4iwEaJGjsitBAohb16cwtD"><div><span class="inline-wrap"><b>右图：</b></span><span class="inline-wrap">我们使用完全相同的模型（四阶多项式）和数据，但这次在训练过程中加入了权重衰减。</span></div></div><ul class="wolai-block"><li id="n1hJXPX5TKSP9Wz1nqveBa"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>现象</b></span><span class="inline-wrap">：权重衰减会惩罚数值过大的模型参数。为了产生左图中剧烈的弯曲，模型需要非常大的参数值。在正则化的约束下，算法在“拟合数据”和“保持参数值较小”之间找到了一个平衡。</span></li><li id="oqRegGEUFfVWXv8nL7woqR"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>结果</b></span><span class="inline-wrap">：最终的拟合曲线（蓝色线条）变得非常平滑，呈现为一个简单的二次曲线（抛物线）的形态。它不再强求穿过每一个数据点，而是捕捉到了数据的整体分布趋势。虽然这个模型在训练集上的误差比左图要高，但它的</span><span class="inline-wrap"><b>泛化能力</b></span><span class="inline-wrap">得到了极大的提升。</span></li></ul><div class="wolai-block wolai-text" id="58Pm2aqYEY5Bn1WxKTdz6j"><div><span class="inline-wrap">通过这个例子，我们可以清晰地看到，正则化通过限制模型的复杂度，迫使其学习数据中更本质、更普适的规律，从而有效地防止了过拟合，是提升模型泛化能力的关键技术。</span></div></div><h4 class="wolai-block" id="fRovLqNSFCU7Q1uaajyqVi"><span class="inline-wrap">正则化是对抗噪声的利器</span></h4><div class="wolai-block wolai-text" id="6sBzdSEUEEw2Ra8wrMyEeR"><div><span class="inline-wrap">从根本上说，过拟合的本质就是模型把数据中的</span><span class="inline-wrap"><b>噪声（Noise）</b></span><span class="inline-wrap">当成了真实的规律去学习。这部分内容将“噪声”扩展为两种类型，并阐述了正则化如何同时对抗它们。</span></div></div><div class="wolai-block wolai-text" id="wtuEzwxVEJZp8JzoiENrZy"><div><span class="inline-wrap"><b>随机噪声 (Stochastic Noise)</b></span><span class="inline-wrap">：这是我们通常理解的噪声，源于数据采集过程中的随机误差、测量不准确或系统固有的随机性。在下图中，它由噪声水平</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">来表示。</span></div></div><div class="wolai-block" id="mKgTNKaUfQpD5VptGEp2D8"><figure class="wolai-center" style="width: 346.66665289137154px; flex-direction: column"><img src="media/image_12.png" style="width: 100%"/></figure></div><ul class="wolai-block"><li id="6VKyJAXa8dtFtdBUUHkGAY"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>蓝线 (</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma^2=0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap"><b>)</b></span><span class="inline-wrap">：在一个理想的、</span><span class="inline-wrap"><b>完全没有噪声</b></span><span class="inline-wrap">的世界里，模型不需要任何正则化。最优的正则化参数是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda=0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap">。此时任何正则化（</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda&gt;0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap">）都会强迫模型变得过于简单，反而引入不必要的偏差，导致泛化误差上升。</span></li><li id="94dbxVo5gjBBtqMneqsmVm"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>绿线和红线 (</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma^2 &gt; 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8532em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap"><b>)</b></span><span class="inline-wrap">：当数据中存在噪声时，情况发生了改变。模型有了过拟合的风险（即学习噪声）。为了抑制这种风险，我们需要引入正则化。</span></li><li id="JasAXemntXSq9MprHc1jd"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>关键趋势</b></span><span class="inline-wrap">：随着</span><span class="inline-wrap"><b>噪声水平</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap"><b>的增加</b></span><span class="inline-wrap">（从绿线到红线），泛化误差的最低点（图中的圆点）不仅整体上移了，而且向右移动了。这意味着，</span><span class="inline-wrap"><b>数据中的噪声越大，我们就需要越强的正则化（越大的</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap"><b>值）来获得最佳的泛化性能</b></span><span class="inline-wrap">。</span></li></ul><div class="wolai-block wolai-text" id="izV6K93tsXwWw6yjghxEvn"><div><span class="inline-wrap"><b>确定性噪声 (Deterministic Noise)</b></span><span class="inline-wrap">：这是一个源于学习理论的、更深刻的概念。它并非数据本身的随机波动，而是源于我们选择的</span><span class="inline-wrap"><b>模型与真实规律之间的“不匹配”</b></span><span class="inline-wrap">。</span></div></div><div class="wolai-block wolai-text" id="s6Em3yebhqg7QNYi4xuAa4"><div><span class="inline-wrap">如果真实世界运行的规律（Target Function）极其复杂，而我们选择的模型（Hypothesis Set</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">H</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="inline-wrap">）本身能力有限，无法完美描述这个真实规律，那么真实规律中那些“无法被我们模型所捕捉到的部分”，从模型的角度看，其作用就和随机噪声类似，会干扰模型的学习过程。在右图中，它由我们的模型复杂度（固定为<span class="jill"></span>15）与目标模型复杂度</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">Q_f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">之间的差距来体现。</span></div></div><div class="wolai-block" id="q6XYx1wCB9xyny8DPJFvhq"><figure class="wolai-center" style="width: 331.1110979539382px; flex-direction: column"><img src="media/image_13.png" style="width: 100%"/></figure></div><ul class="wolai-block"><li id="jHe1QocfPAp1GusHWJfzLZ"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>蓝线 (</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>f</mi></msub><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">Q_f=15</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">15</span></span></span></span></span><span class="inline-wrap"><b>)</b></span><span class="inline-wrap">：当我们的模型复杂度与目标复杂度</span><span class="inline-wrap"><b>完全匹配</b></span><span class="inline-wrap">时，不存在确定性噪声。此时和左图的无噪声情况一样，最优选择是</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda=0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span class="inline-wrap">。</span></li><li id="mLzjFS5aWpWJrXsWqvXr4K"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>绿线和红线 (</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Q</mi><mi>f</mi></msub><mo>&gt;</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">Q_f &gt; 15</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">15</span></span></span></span></span><span class="inline-wrap"><b>)</b></span><span class="inline-wrap">：当真实规律的复杂度远超我们模型的表达能力时（例如真实规律是<span class="jill"></span>100<span class="jill"></span>阶多项式，我们却用<span class="jill"></span>15<span class="jill"></span>阶多项式去拟合），确定性噪声就出现了。</span></li><li id="zUijRUShSMnMnA5oaqeh"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>关键趋势</b></span><span class="inline-wrap">：真实规律与我们模型之间的</span><span class="inline-wrap"><b>复杂度差距越大</b></span><span class="inline-wrap">（确定性噪声越大），我们也需要</span><span class="inline-wrap"><b>越强的正则化（越大的</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap"><b>值）</b></span><span class="inline-wrap">来使得模型表现最好。</span></li></ul><div class="wolai-block wolai-text" id="95NndXVv1Figs4RHHWnBY1"><div><span class="inline-wrap">这似乎有些反直觉，但可以这样理解：当模型无论如何都无法完美拟合复杂的目标时，正则化会迫使它放弃“徒劳地”追逐那些无法捕捉的细节，转而寻找一个更简单、更稳健的近似解。</span></div></div><div class="wolai-block wolai-text" id="fyTiqNHkGuwxjbSrGnzNUf"><div><span class="inline-wrap">总之，不论是源于数据随机性的随机噪声，还是源于模型与现实差距的确定性噪声，它们都会导致过拟合。正则化是抑制这两种噪声影响的统一手段，并且噪声越大，我们所需要的正则化强度就应该越高。</span></div></div><h3 class="wolai-block" id="8xWr8HDjztqo7Q5xWhCFtx"><span class="inline-wrap">评估的公正性</span></h3><h4 class="wolai-block" id="uddKmB2eRsUHQNPNz5X5et"><span class="inline-wrap"><b>数据窥探（Data Snooping）</b></span></h4><div class="wolai-block wolai-text" id="5FgprGNY4nJq3bV7JrmnoA"><div><span class="inline-wrap">在机器学习中，我们所有努力的最终目标是构建一个模型，使其在</span><span class="inline-wrap"><b>未来的、未曾见过的数据</b></span><span class="inline-wrap">上表现良好。为了衡量这一能力，我们预留出一部分数据作为</span><span class="inline-wrap"><b>测试集（Test Set）</b></span><span class="inline-wrap">，用它来模拟未来的未知数据，并以此评估模型的最终性能。</span></div></div><div class="wolai-block" id="w5ShDqbUCTJgtAWkLVLWge"><figure class="wolai-center" style="width: 569.4444218167562px; flex-direction: column"><img alt="Stanford CS 229 Stanford CS 229 " src="media/train-val-test-en.png" style="width: 100%"/><figcaption>Stanford CS 229</figcaption></figure></div><div class="wolai-block wolai-text" id="v1aR9oaUHhxhLQ2kvG2dDo"><div><span class="inline-wrap">这就引出了机器学习实践中一条至关重要的、不可逾越的红线：</span><span class="inline-wrap"><b>任何用于最终评估的数据集，都绝不能在学习过程的任何一个环节中影响模型的构建或选择。</b></span></div></div><div class="wolai-block wolai-text" id="7HkSZPRS8TiJS8NBF7tQdo"><div><span class="inline-wrap">一旦这个原则被违背，我们就称之为</span><span class="inline-wrap"><b>数据窥探（Data Snooping）</b></span><span class="inline-wrap">。当数据窥探发生时，测试集就不再是“未知”的了，它在某种程度上已经“污染”了我们的模型。因此，这个测试集评估模型性能的能力已经被彻底破坏了。模型在被污染的测试集上取得的高分，往往是一种虚假的繁荣，它掩盖了严重的过拟合问题，会给我们一种模型泛化能力很强的错觉，但在真实世界的应用中将表现得一塌糊涂。</span></div></div><div class="wolai-block wolai-text" id="thWyxdzcmwTV781LoiH7t9"><div><span class="inline-wrap">数据窥探是一个极其常见且有时非常隐蔽的陷阱。例如：</span></div></div><ul class="wolai-block"><li id="mUHJUxMmSW6vERYb5wFRwN"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>最明显的方式</b></span><span class="inline-wrap">：直接在测试集上训练模型。</span></li><li id="3qRrR7jsbdjs7kwphJ9Vnx"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>常见的方式</b></span><span class="inline-wrap">：使用测试集的表现来调整模型的超参数（比如正则化强度</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">）。你可能会尝试多个</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">值，选择在测试集上得分最高的那个，然后将这个分数作为最终结果报告。但实际上，你的超参数选择过程已经“窥探”了测试集。</span></li><li id="f2VZF4LCCmGXdCVnVCFKim"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>更隐蔽的方式</b></span><span class="inline-wrap">：你开发了<span class="jill"></span>20<span class="jill"></span>个不同的模型，用测试集逐一评估，然后挑选表现最好的那个模型。这个“挑选”行为本身，就是被测试集影响的学习过程。</span></li></ul><div class="wolai-block wolai-text" id="3NR423yYiQtJJY5bEyF7Vz"><div><span class="inline-wrap">为了生动地展示数据窥探的荒谬性和危害性，我们可以看一个例子：一篇名为《Pretraining on the Test Set Is All You Need》的学术论文。</span></div></div><div class="wolai-block" id="ootF7z7bUYVAFSegDmyzZK"><figure class="wolai-center" style="width: 348.3333194918108px; flex-direction: column"><img src="media/image_14.png" style="width: 100%"/></figure></div><div class="wolai-block wolai-text" id="aVb8Ynyed2PoLPBk2eKXwm"><div><span class="inline-wrap">该论文声称其模型在一系列基准测试中取得了惊人的、超越所有现有模型的效果。然而，在论文的末尾有一个声明：</span><span class="inline-wrap"><b>这篇文章是讽刺的</b></span><span class="inline-wrap">。其惊人效果的来源，恰恰是因为模型在开发阶段就使用了这些基准测试的</span><span class="inline-wrap"><b>测试集</b></span><span class="inline-wrap">进行训练。这个例子以一种幽默而尖锐的方式，揭示了数据窥探会如何产生毫无意义且极具误导性的结果。</span></div></div><h4 class="wolai-block" id="oPDsvMKK82CFxY9ZCVdMeE"><span class="inline-wrap"><b>机器学习的正确实践</b></span></h4><div class="wolai-block wolai-text" id="mG2ArweTShupZpyhYSe2Yc"><div><span class="inline-wrap">既然测试集如此神圣不可侵犯，那么我们该如何选择模型、调整超参数呢？这就需要我们之前讨论过的两个核心工具：</span></div></div><ol class="wolai-block"><li id="2reeZhyswARrLtkASfTVQf"><div class="marker"></div><span class="inline-wrap"><b>验证 (Validation)</b></span><span class="inline-wrap">：这是为了避免数据窥探而设计的关键技术。我们从</span><span class="inline-wrap"><b>训练数据</b></span><span class="inline-wrap">中再划分出一小部分作为</span><span class="inline-wrap"><b>验证集 (Validation Set)</b></span><span class="inline-wrap">。这个验证集在模型开发阶段</span><span class="inline-wrap"><b>充当测试集的“模拟考”</b></span><span class="inline-wrap">。我们可以用它来估算模型的泛化误差（</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_{out}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap">），从而指导我们选择最佳的超参数（如选择最合适的</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span></span></span></span></span><span class="inline-wrap">值）、进行模型选择等，而这一切都无需触碰那份留作“最终大考”的、真正独立的测试集。</span></li><li id="iPiJttQ6EHjJQtUjPFZS2v"><div class="marker"></div><span class="inline-wrap"><b>正则化 (Regularization)</b></span><span class="inline-wrap">：这是另一种直接作用于模型内部的强大工具。它通过向目标函数添加一个惩罚项，来抑制单个模型的复杂度。正如我们之前所见，正则化能够有效对抗由</span><span class="inline-wrap"><b>随机噪声</b></span><span class="inline-wrap">（数据自身的随机性）和</span><span class="inline-wrap"><b>确定性噪声</b></span><span class="inline-wrap">（模型无法完美匹配真实规律）共同导致的过拟合问题。</span></li></ol><div class="wolai-block wolai-text" id="i5oiWosSqLamAYanL53TUZ"><div><span class="inline-wrap"><b>理论与实践的关系</b></span></div></div><div class="wolai-block wolai-text" id="ftsgcTgpMGUJyX5s1RPGrZ"><div><span class="inline-wrap">那么，像<span class="jill"></span>VC<span class="jill"></span>维这样的学习理论，与验证、正则化这些实践技术之间是什么关系呢？</span></div></div><ul class="wolai-block"><li id="HLst9NDq9rnX8eEbWFvLR"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>理论的挑战</b></span><span class="inline-wrap">：严格地对验证、交叉验证或正则化进行<span class="jill"></span>VC<span class="jill"></span>分析是极其困难且不直观的。纯粹的理论分析往往难以完全覆盖这些复杂而实用的工程技巧。</span></li><li id="rgWohbr3zCQips6PC9RcqJ"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap"><b>正确的协同方式</b></span><span class="inline-wrap">：</span><span class="inline-wrap"><b>用理论来指导实践</b></span><span class="inline-wrap">。这才是理论在机器学习中发挥最大价值的方式。</span><ul class="wolai-block"><li id="4HvdZEcFJi67N5mFXsRKzt"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">VC<span class="jill"></span>理论告诉我们，模型的泛化能力与</span><span class="inline-wrap"><b>复杂度</b></span><span class="inline-wrap">息息相关。这个理论</span><span class="inline-wrap"><b>启发</b></span><span class="inline-wrap">我们去实践中发明和使用</span><span class="inline-wrap"><b>正则化</b></span><span class="inline-wrap">，通过约束模型的“有效复杂度”来获得更好的泛化能力。</span></li><li id="xu3KQwbc39n2zWKcseEgKt"><div class="marker"><svg fill="currentColor" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">泛化理论告诉我们，我们需要一个对</span><span class="inline-wrap"><b>泛化误差</b></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_{out}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="inline-wrap"><b>的无偏估计</b></span><span class="inline-wrap">。这个理论</span><span class="inline-wrap"><b>启发</b></span><span class="inline-wrap">我们去实践中划分出</span><span class="inline-wrap"><b>验证集和测试集</b></span><span class="inline-wrap">，以获得对模型未来表现的可靠评估。</span></li></ul></li></ul><div class="wolai-block wolai-text" id="mRNhsWU5vFkeAx5eQYqqPF"><div><span class="inline-wrap">最终，我们需要认识到，从数据中学习本质上是一个</span><span class="inline-wrap"><b>以实践为核心的经验性任务，并由深刻的理论所支撑</b></span><span class="inline-wrap">。理论为我们指明了正确的方向和应遵循的原则，但一种方法是否真正有效，唯一的评判标准是将其在真实的应用场景中进行严谨的实现和检验。</span></div></div><div class="wolai-block wolai-text" id="ozY3riyByfo3rz3T8tDwuG"><div></div></div></article><footer></footer></body></html>